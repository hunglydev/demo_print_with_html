const bearerToken =
    "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOlwvXC9hcGktdjIubWFzdGVycHJvLnZuXC9cL2FwaVwvYXV0aFwvbG9naW4iLCJpYXQiOjE3MzEwNTAzMTEsImV4cCI6MTczMTA2ODMxMSwibmJmIjoxNzMxMDUwMzExLCJqdGkiOiJIYW9TZ0hmMWh6MGJ4ODhkIiwic3ViIjoxODM5LCJwcnYiOiI5NGRiZDk2MWFhZWYwZTNjZTY2YWQ3ZDUwZTY0NzcxNzYwOWRkYTI0IiwiYmFzZV90b2tlbiI6ImV5SmhiR2NpT2lKSVV6STFOaUlzSW5SNWNDSTZJa3BYVkNKOS5leUp6ZFdJaU9pSjBZWEJvYjJGeVpYWnBaWGNpTENKaGVuQWlPaUpoWkcxcGJpSXNJbXAwYVNJNklqZzFZamd6TURFNUxUUXlPVGd0TkRWbFppMDRaRFU0TFdNek1UZGxZV1E1WkRrMVl5SXNJbTVoYldWcFpDSTZJakl5TWlJc0ltVjRjQ0k2TVRjek5qSXpORE16TUN3aWMybGtJam9pSWl3aWJtSm1Jam94TnpNeE1EVXdNek13TENKcGMzTWlPaUpvYjNOamJ5NTJiaUlzSW1GMVpDSTZJbWh2YzJOdkxuWnVJbjAudGQ4eUp2eUx4eGFJdVlIU3NIQ3VYNU9ZdFlGVDRoOXRlX2NOMnlwaTB0VSIsInRlbmFudF9jb2RlIjoidGFwaG9hcmV2aWV3IiwibGV2ZWwiOjAsIkVtcGxveWVlSWQiOiJiODUzOGEyZi03OTcwLTQyYWQtYmM1NS1jNGI4NzNmYWNjMTgifQ.go0ZWJwZ_9snlSF8uRizLrDwad4HIl957Vo11WfOHYw";

String htmlBase64 =
    "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KCjxoZWFkPgogICAgPG1ldGEgY2hhcnNldD0iVVRGLTgiPgogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPgogICAgPG1ldGEgaHR0cC1lcXVpdj0iWC1VQS1Db21wYXRpYmxlIiBjb250ZW50PSJpZT1lZGdlIj4KICAgIDx0aXRsZT5N4bqrdSBob8OhIMSRxqFuPC90aXRsZT4KPC9oZWFkPgoKPGJvZHk+CiAgICA8ZGl2IGlkPSJjb250YWluZXIiPjwvZGl2PgogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY29kZS5qcXVlcnkuY29tL2pxdWVyeS0zLjcuMS5qcyIgaW50ZWdyaXR5PSJzaGEyNTYtZUtoYXlpOExFUXdwNE5LeE4rQ2ZDaCszcU9WVXRKbjNRTlowVGNpV0xQND0iCiAgICAgICAgY3Jvc3NvcmlnaW49ImFub255bW91cyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0PgogICAgICAgIGZ1bmN0aW9uIHByaW50VGVtcGxhdGUoKSB7CiAgICAgICAgICAgIHZhciBpbmZvID0geyJpbnZvaWNlX2lkIjoiMTEzIiwiY29tcGFueV9uYW1lIjoiSG9zY28iLCJzdG9yZV9uYW1lIjoiSG9zY28gU3RvcmUiLCJzdG9yZV9hZGRyZXNzIjoiU1x1MWVkMSAxIFx1MDExMFx1MDFiMFx1MWVkZG5nIENcdTFlZDUgTmh1XHUxZWJmLCBIXHUwMGUwIE5cdTFlZDlpLCBWaVx1MWVjN3QgTmFtIiwic3RvcmVfcGhvbmUiOiIwOTY4Nzk4OTQ1Iiwib3JkZXJfZGF0ZSI6IjIwMjQtMTEtMDgiLCJvcmRlcl9jb2RlIjoiSU5WMjAyNDExMDgiLCJlbXBsb3llZV9uYW1lIjoiVlx1MDE2OSBDXHUwMGY0bmcgVHVcdTFlYTVuIEFuaCIsImVtcGxveWVlX2NvZGUiOiJFTVAxMjM0NSIsImN1c3RvbWVyX25hbWUiOiJOZ3V5XHUxZWM1biBWXHUwMTAzbiBBIiwiY3VzdG9tZXJfcGhvbmUiOiIwOTEyMzQ1Njc4IiwiY3VzdG9tZXJfYWRkcmVzcyI6IjEyMyBcdTAxMTBcdTAxYjBcdTFlZGRuZyBMXHUwMGUxbmcsIEhcdTAwZTAgTlx1MWVkOWkiLCJjdXN0b21lcl9wb2ludCI6IjIwMCIsInByb2R1Y3RzIjpbeyJuYW1lIjoiQlx1MDBlMW5oIG1cdTAwZWMiLCJjb2RlIjoiQk0wMDEiLCJxdWFudGl0eSI6IjIiLCJ1bml0IjoiY1x1MDBlMWkiLCJwcmljZSI6IjIwMDAwIiwiZl9kaXNjb3VudCI6IjAiLCJtX2Rpc2NvdW50IjoiMCIsInRheCI6IjUiLCJ0b3RhbCI6IjQwMDAwIn0seyJuYW1lIjoiU1x1MWVlZmEgdFx1MDFiMFx1MDFhMWkiLCJjb2RlIjoiU1QwMDIiLCJxdWFudGl0eSI6IjEiLCJ1bml0IjoiaFx1MWVkOXAiLCJwcmljZSI6IjE1MDAwIiwiZl9kaXNjb3VudCI6IjAiLCJtX2Rpc2NvdW50IjoiMCIsInRheCI6IjUiLCJ0b3RhbCI6IjE1MDAwIn0seyJuYW1lIjoiTlx1MDFiMFx1MWVkYmMgbmdcdTFlY2R0IiwiY29kZSI6Ik5OMDAzIiwicXVhbnRpdHkiOiIzIiwidW5pdCI6ImNoYWkiLCJwcmljZSI6IjEwMDAwIiwiZl9kaXNjb3VudCI6IjEwMDAiLCJtX2Rpc2NvdW50IjoiMCIsInRheCI6IjUiLCJ0b3RhbCI6IjI3MDAwIn0seyJuYW1lIjoiQlx1MDBlMW5oIG1cdTAwZWMiLCJjb2RlIjoiQk0wMDEiLCJxdWFudGl0eSI6IjIiLCJ1bml0IjoiY1x1MDBlMWkiLCJwcmljZSI6IjIwMDAwIiwiZl9kaXNjb3VudCI6IjAiLCJtX2Rpc2NvdW50IjoiMCIsInRheCI6IjUiLCJ0b3RhbCI6IjQwMDAwIn0seyJuYW1lIjoiU1x1MWVlZmEgdFx1MDFiMFx1MDFhMWkiLCJjb2RlIjoiU1QwMDIiLCJxdWFudGl0eSI6IjEiLCJ1bml0IjoiaFx1MWVkOXAiLCJwcmljZSI6IjE1MDAwIiwiZl9kaXNjb3VudCI6IjAiLCJtX2Rpc2NvdW50IjoiMCIsInRheCI6IjUiLCJ0b3RhbCI6IjE1MDAwIn0seyJuYW1lIjoiTlx1MDFiMFx1MWVkYmMgbmdcdTFlY2R0IiwiY29kZSI6Ik5OMDAzIiwicXVhbnRpdHkiOiIzIiwidW5pdCI6ImNoYWkiLCJwcmljZSI6IjEwMDAwIiwiZl9kaXNjb3VudCI6IjEwMDAiLCJtX2Rpc2NvdW50IjoiMCIsInRheCI6IjUiLCJ0b3RhbCI6IjI3MDAwIn0seyJuYW1lIjoiQlx1MDBlMW5oIG1cdTAwZWMiLCJjb2RlIjoiQk0wMDEiLCJxdWFudGl0eSI6IjIiLCJ1bml0IjoiY1x1MDBlMWkiLCJwcmljZSI6IjIwMDAwIiwiZl9kaXNjb3VudCI6IjAiLCJtX2Rpc2NvdW50IjoiMCIsInRheCI6IjUiLCJ0b3RhbCI6IjQwMDAwIn0seyJuYW1lIjoiU1x1MWVlZmEgdFx1MDFiMFx1MDFhMWkiLCJjb2RlIjoiU1QwMDIiLCJxdWFudGl0eSI6IjEiLCJ1bml0IjoiaFx1MWVkOXAiLCJwcmljZSI6IjE1MDAwIiwiZl9kaXNjb3VudCI6IjAiLCJtX2Rpc2NvdW50IjoiMCIsInRheCI6IjUiLCJ0b3RhbCI6IjE1MDAwIn0seyJuYW1lIjoiTlx1MDFiMFx1MWVkYmMgbmdcdTFlY2R0IiwiY29kZSI6Ik5OMDAzIiwicXVhbnRpdHkiOiIzIiwidW5pdCI6ImNoYWkiLCJwcmljZSI6IjEwMDAwIiwiZl9kaXNjb3VudCI6IjEwMDAiLCJtX2Rpc2NvdW50IjoiMCIsInRheCI6IjUiLCJ0b3RhbCI6IjI3MDAwIn1dLCJ0b3RhbF93aXRob3V0X2Rpc2NvdW50IjoiODIwMDAiLCJ0b3RhbF9xdWFudGl0eSI6IjYiLCJtaW51c19wb2ludCI6IjAiLCJtb25leV9ndWVzdCI6IjEwMDAwMCIsInRvdGFsX2Rpc2NvdW50X3ByaWNlIjoiMTAwMCIsInRvdGFsX3ByaWNlIjoiODEwMDAiLCJwZXJjZW50X2Rpc2NvdW50IjoiMS4yMiUiLCJtb25leV9yZXR1cm4iOiIxOTAwMCIsIm1vbmV5X3dvcmRzIjoiTVx1MDFiMFx1MWVkZGkgY2hcdTAwZWRuIG5naFx1MDBlY24gXHUwMTExXHUxZWQzbmciLCJtb25leV90YXgiOiI0MTAwIiwidGF4IjoiNSUiLCJ0eXBlX3BheW1lbnQiOiJUaVx1MWVjMW4gbVx1MWViN3QiLCJkZXNjcmlwdGlvbiI6IlRoYW5oIHRvXHUwMGUxbiB0XHUxZWExaSBxdVx1MWVhN3kifTsKICAgICAgICAgICAgdmFyIHByb2R1Y3RzID0gW3sibmFtZSI6IkJcdTAwZTFuaCBtXHUwMGVjIiwiY29kZSI6IkJNMDAxIiwicXVhbnRpdHkiOiIyIiwidW5pdCI6ImNcdTAwZTFpIiwicHJpY2UiOiIyMDAwMCIsImZfZGlzY291bnQiOiIwIiwibV9kaXNjb3VudCI6IjAiLCJ0YXgiOiI1IiwidG90YWwiOiI0MDAwMCJ9LHsibmFtZSI6IlNcdTFlZWZhIHRcdTAxYjBcdTAxYTFpIiwiY29kZSI6IlNUMDAyIiwicXVhbnRpdHkiOiIxIiwidW5pdCI6ImhcdTFlZDlwIiwicHJpY2UiOiIxNTAwMCIsImZfZGlzY291bnQiOiIwIiwibV9kaXNjb3VudCI6IjAiLCJ0YXgiOiI1IiwidG90YWwiOiIxNTAwMCJ9LHsibmFtZSI6Ik5cdTAxYjBcdTFlZGJjIG5nXHUxZWNkdCIsImNvZGUiOiJOTjAwMyIsInF1YW50aXR5IjoiMyIsInVuaXQiOiJjaGFpIiwicHJpY2UiOiIxMDAwMCIsImZfZGlzY291bnQiOiIxMDAwIiwibV9kaXNjb3VudCI6IjAiLCJ0YXgiOiI1IiwidG90YWwiOiIyNzAwMCJ9LHsibmFtZSI6IkJcdTAwZTFuaCBtXHUwMGVjIiwiY29kZSI6IkJNMDAxIiwicXVhbnRpdHkiOiIyIiwidW5pdCI6ImNcdTAwZTFpIiwicHJpY2UiOiIyMDAwMCIsImZfZGlzY291bnQiOiIwIiwibV9kaXNjb3VudCI6IjAiLCJ0YXgiOiI1IiwidG90YWwiOiI0MDAwMCJ9LHsibmFtZSI6IlNcdTFlZWZhIHRcdTAxYjBcdTAxYTFpIiwiY29kZSI6IlNUMDAyIiwicXVhbnRpdHkiOiIxIiwidW5pdCI6ImhcdTFlZDlwIiwicHJpY2UiOiIxNTAwMCIsImZfZGlzY291bnQiOiIwIiwibV9kaXNjb3VudCI6IjAiLCJ0YXgiOiI1IiwidG90YWwiOiIxNTAwMCJ9LHsibmFtZSI6Ik5cdTAxYjBcdTFlZGJjIG5nXHUxZWNkdCIsImNvZGUiOiJOTjAwMyIsInF1YW50aXR5IjoiMyIsInVuaXQiOiJjaGFpIiwicHJpY2UiOiIxMDAwMCIsImZfZGlzY291bnQiOiIxMDAwIiwibV9kaXNjb3VudCI6IjAiLCJ0YXgiOiI1IiwidG90YWwiOiIyNzAwMCJ9LHsibmFtZSI6IkJcdTAwZTFuaCBtXHUwMGVjIiwiY29kZSI6IkJNMDAxIiwicXVhbnRpdHkiOiIyIiwidW5pdCI6ImNcdTAwZTFpIiwicHJpY2UiOiIyMDAwMCIsImZfZGlzY291bnQiOiIwIiwibV9kaXNjb3VudCI6IjAiLCJ0YXgiOiI1IiwidG90YWwiOiI0MDAwMCJ9LHsibmFtZSI6IlNcdTFlZWZhIHRcdTAxYjBcdTAxYTFpIiwiY29kZSI6IlNUMDAyIiwicXVhbnRpdHkiOiIxIiwidW5pdCI6ImhcdTFlZDlwIiwicHJpY2UiOiIxNTAwMCIsImZfZGlzY291bnQiOiIwIiwibV9kaXNjb3VudCI6IjAiLCJ0YXgiOiI1IiwidG90YWwiOiIxNTAwMCJ9LHsibmFtZSI6Ik5cdTAxYjBcdTFlZGJjIG5nXHUxZWNkdCIsImNvZGUiOiJOTjAwMyIsInF1YW50aXR5IjoiMyIsInVuaXQiOiJjaGFpIiwicHJpY2UiOiIxMDAwMCIsImZfZGlzY291bnQiOiIxMDAwIiwibV9kaXNjb3VudCI6IjAiLCJ0YXgiOiI1IiwidG90YWwiOiIyNzAwMCJ9XTsKICAgICAgICAgICAgbGV0IGl0ZW1Qcm9kdWN0cyA9IFsKCiAgICAgICAgICAgIF07CiAgICAgICAgICAgIHByb2R1Y3RzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7CiAgICAgICAgICAgICAgICBpdGVtUHJvZHVjdHMucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgU1RUX1NQOiBpbmRleCsxLAogICAgICAgICAgICAgICAgICAgIENPREU6aXRlbS5jb2RlLAogICAgICAgICAgICAgICAgICAgIFRFTl9TUDogaXRlbS5uYW1lLAogICAgICAgICAgICAgICAgICAgIFFVQU5USVRZOiBpdGVtLnF1YW50aXR5LAogICAgICAgICAgICAgICAgICAgIFBSSUNFOiBpdGVtLnByaWNlLAogICAgICAgICAgICAgICAgICAgIEZfRElTQ09VTlQ6IGl0ZW0uZl9kaXNjb3VudCwKICAgICAgICAgICAgICAgICAgICBNX0RJU0NPVU5UOiBpdGVtLm1fZGlzY291bnQsCiAgICAgICAgICAgICAgICAgICAgVE9UQUw6IGl0ZW0udG90YWwsCiAgICAgICAgICAgICAgICAgICAgVkFUX1NQOiBpdGVtLnRheCwKICAgICAgICAgICAgICAgICAgICBEVlRfU1A6IGl0ZW0udW5pdCwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBhZ2VWYXJpYWJsZSA9IHsKICAgICAgICAgICAgICAgIGNvbnNpZ25tZW50RXhhbXBsZXM6IHsKICAgICAgICAgICAgICAgICAgICBub21hbEl0ZW1zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIExPR09fRE9BTkhfTkdISUVQOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgVEVOX0RPQU5IX05HSElFUDogaW5mby5zdG9yZV9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICBESUFfQ0hJX0RPQU5IX05HSElFUDogaW5mby5zdG9yZV9hZGRyZXNzLAogICAgICAgICAgICAgICAgICAgICAgICBTRFRfRE9BTkhfTkdISUVQOiBpbmZvLnN0b3JlX3Bob25lLAogICAgICAgICAgICAgICAgICAgICAgICBFTVBMT1lFRV9OQU1FOiBpbmZvLmVtcGxveWVlX25hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIEVNUExPWUVFX0NPREU6IGluZm8uZW1wbG95ZWVfY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgQ1VTVE9NRVJfTkFNRTogaW5mby5jdXN0b21lcl9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICBDVVNUT01FUl9QSE9ORTogaW5mby5jdXN0b21lcl9waG9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgQ1VTVE9NRVJfQUREUkVTUzogaW5mby5jdXN0b21lcl9hZGRyZXNzLAogICAgICAgICAgICAgICAgICAgICAgICBDVVNUT01FUl9QT0lOVDogaW5mby5jdXN0b21lcl9wb2ludCwKICAgICAgICAgICAgICAgICAgICAgICAgT1JERVJfQ09ERTogaW5mby5vcmRlcl9jb2RlLAogICAgICAgICAgICAgICAgICAgICAgICBPUkRFUl9EQVRFOiBpbmZvLm9yZGVyX2RhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRPTkdfVElFTjogaW5mby50b3RhbF9wcmljZSwKICAgICAgICAgICAgICAgICAgICAgICAgVE9UQUxfV0lUSE9VVF9ESVNDT1VOVDogaW5mby50b3RhbF93aXRob3V0X2Rpc2NvdW50LAogICAgICAgICAgICAgICAgICAgICAgICBUT1RBTF9RVUFOVElUWTogaW5mby50b3RhbF9xdWFudGl0eSwKICAgICAgICAgICAgICAgICAgICAgICAgTUlOVVNfUE9JTlQ6IGluZm8ubWludXNfcG9pbnQsCiAgICAgICAgICAgICAgICAgICAgICAgIE1PTkVZX0dVRVNUOiBpbmZvLm1vbmV5X2d1ZXN0LAogICAgICAgICAgICAgICAgICAgICAgICBUT1RBTF9ESVNDT1VOVF9QUklDRTogaW5mby50b3RhbF9kaXNjb3VudF9wcmljZSwKICAgICAgICAgICAgICAgICAgICAgICAgUEVSQ0VOVF9ESVNDT1VOVDogaW5mby5wZXJjZW50X2Rpc2NvdW50LAogICAgICAgICAgICAgICAgICAgICAgICBNT05FWV9SRVRVUk46IGluZm8ubW9uZXlfcmV0dXJuLAogICAgICAgICAgICAgICAgICAgICAgICBNT05FWV9XT1JEUzogaW5mby5tb25leV93b3JkcywKICAgICAgICAgICAgICAgICAgICAgICAgTU9ORVlfVEFYOiBpbmZvLm1vbmV5X3RheCwKICAgICAgICAgICAgICAgICAgICAgICAgVEFYOiBpbmZvLnRheCwKICAgICAgICAgICAgICAgICAgICAgICAgVFlQRV9QQVlNRU5UOiBpbmZvLnR5cGVfcGF5bWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgREVTQ1JJUFRJT046IGluZm8uZGVzY3JpcHRpb24sCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBpbnRlcnZhbEl0ZW1zOiBpdGVtUHJvZHVjdHMsCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9OwoKICAgICAgICAgICAgdmFyIHBhZ2VGdW5jdGlvbnMgPSB7CiAgICAgICAgICAgICAgICByZXBsYWNlVGVtcGxhdGU6IGZ1bmN0aW9uKHRlbXBsYXRlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCF0ZW1wbGF0ZSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIiI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vIMOE4oCYw6HCusKndSB0acODwqpuIHbDocK74oC6aSBuaMOhwrvCr25nIHTDocK7wqsga2jDg8KzYSBidAogICAgICAgICAgICAgICAgICAgIHZhciBpLCBqLCBrZXl3b3JkOwogICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZW9mIHBhZ2VWYXJpYWJsZS5jb25zaWdubWVudEV4YW1wbGVzICE9ICJ1bmRlZmluZWQiICYmCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVvZiBwYWdlVmFyaWFibGUuY29uc2lnbm1lbnRFeGFtcGxlcy5ub21hbEl0ZW1zICE9ICJ1bmRlZmluZWQiCiAgICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSBpbiBwYWdlVmFyaWFibGUuY29uc2lnbm1lbnRFeGFtcGxlcy5ub21hbEl0ZW1zKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZSA9IHRoaXMucmVwbGFjZUFsbCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAieyIgKyBpICsgIn0iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VWYXJpYWJsZS5jb25zaWdubWVudEV4YW1wbGVzLm5vbWFsSXRlbXNbaV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wRG9jID0gJCgiPGRpdi8+IikuaHRtbCh0ZW1wbGF0ZSk7CgogICAgICAgICAgICAgICAgICAgIHZhciBoYXNJbnRlcnZhbENvbnNpZ25tZW50ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlSW50ZXJ2YWwgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZUludGVydmFsMSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRyU3RhcnQgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgICAgICB0eXBlb2YgcGFnZVZhcmlhYmxlLmNvbnNpZ25tZW50RXhhbXBsZXMgIT0gInVuZGVmaW5lZCIgJiYKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZW9mIHBhZ2VWYXJpYWJsZS5jb25zaWdubWVudEV4YW1wbGVzLmludGVydmFsSXRlbXMgIT0gInVuZGVmaW5lZCIKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChqIGluIHBhZ2VWYXJpYWJsZS5jb25zaWdubWVudEV4YW1wbGVzLmludGVydmFsSXRlbXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoa2V5d29yZCBpbiBwYWdlVmFyaWFibGUuY29uc2lnbm1lbnRFeGFtcGxlcy5pbnRlcnZhbEl0ZW1zWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wRG9jLmZpbmQoIjpjb250YWlucygnIiArIGtleXdvcmQgKyAiJykiKS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcERvYwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoIjpjb250YWlucygnIiArIGtleXdvcmQgKyAiJykiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0YWJsZUludGVydmFsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlSW50ZXJ2YWwgPSAkKHRoaXMpLmNsb3Nlc3QoInRhYmxlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0ludGVydmFsQ29uc2lnbm1lbnQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZW9mIHBhZ2VWYXJpYWJsZS5jb25zaWdubWVudEV4YW1wbGVzICE9ICJ1bmRlZmluZWQiICYmCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVvZiBwYWdlVmFyaWFibGUuY29uc2lnbm1lbnRFeGFtcGxlcy5pbnRlcnZhbEl0ZW1zMSAhPQogICAgICAgICAgICAgICAgICAgICAgICAidW5kZWZpbmVkIgogICAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGogaW4gcGFnZVZhcmlhYmxlLmNvbnNpZ25tZW50RXhhbXBsZXMuaW50ZXJ2YWxJdGVtczEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoa2V5d29yZCBpbiBwYWdlVmFyaWFibGUuY29uc2lnbm1lbnRFeGFtcGxlcy5pbnRlcnZhbEl0ZW1zMVsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgagogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGVtcERvYy5maW5kKCI6Y29udGFpbnMoJyIgKyBrZXl3b3JkICsgIicpIikubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBEb2MKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCI6Y29udGFpbnMoJyIgKyBrZXl3b3JkICsgIicpIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGFibGVJbnRlcnZhbDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVJbnRlcnZhbDEgPSAkKHRoaXMpLmNsb3Nlc3QoInRhYmxlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0ludGVydmFsQ29uc2lnbm1lbnQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmIChoYXNJbnRlcnZhbENvbnNpZ25tZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZUludGVydmFsID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlSW50ZXJ2YWwxID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRyU3RhcnQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRyU3RhcnQxID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGzDocK6wqV5IHJhIHRhYmxlIGPDhcKpbmcgbmjDhsKwIHRyIMOE4oCYw6HCusKndSB0acODwqpuIGLDocK6wq90IMOE4oCYw6HCusKndSBpbnRlcnZhbAogICAgICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlb2YgcGFnZVZhcmlhYmxlLmNvbnNpZ25tZW50RXhhbXBsZXMgIT0gInVuZGVmaW5lZCIgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVvZiBwYWdlVmFyaWFibGUuY29uc2lnbm1lbnRFeGFtcGxlcy5pbnRlcnZhbEl0ZW1zICE9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW5kZWZpbmVkIgogICAgICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaiBpbiBwYWdlVmFyaWFibGUuY29uc2lnbm1lbnRFeGFtcGxlcy5pbnRlcnZhbEl0ZW1zKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChrZXl3b3JkIGluIHBhZ2VWYXJpYWJsZS5jb25zaWdubWVudEV4YW1wbGVzLmludGVydmFsSXRlbXNbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcERvYwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoIjpjb250YWlucygnIiArIGtleXdvcmQgKyAiJykiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbG9uZSgpIC8vY2xvbmUgdGhlIGVsZW1lbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNoaWxkcmVuKCkgLy9zZWxlY3QgYWxsIHRoZSBjaGlsZHJlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlKCkgLy9yZW1vdmUgYWxsIHRoZSBjaGlsZHJlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZW5kKCkgLy9hZ2FpbiBnbyBiYWNrIHRvIHNlbGVjdGVkIGVsZW1lbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigiOmNvbnRhaW5zKCciICsga2V5d29yZCArICInKSIpLmxlbmd0aCA+IDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGFibGVJbnRlcnZhbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUludGVydmFsID0gJCh0aGlzKS5jbG9zZXN0KCJ0YWJsZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHJJbmRleCA9IHRhYmxlSW50ZXJ2YWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoInRib2R5IHRyIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmluZGV4KCQodGhpcykuY2xvc2VzdCgidHIiKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRySW5kZXggIT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJTdGFydCA9PT0gZmFsc2UgfHwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyU3RhcnQgPT0gLTEgfHwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyU3RhcnQgPiB0ckluZGV4CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJTdGFydCA9IHRySW5kZXg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGzDocK6wqV5IHJhIHRhYmxlIGPDhcKpbmcgbmjDhsKwIHRyIMOE4oCYw6HCusKndSB0acODwqpuIGLDocK6wq90IMOE4oCYw6HCusKndSBpbnRlcnZhbDEgKGjDg8KzYSDDhOKAmMOGwqFuIMOE4oCYw6HCu+KAomkgdHLDocK6wqMgaMODIG5nKQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlb2YgcGFnZVZhcmlhYmxlLmNvbnNpZ25tZW50RXhhbXBsZXMgIT0gInVuZGVmaW5lZCIgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVvZiBwYWdlVmFyaWFibGUuY29uc2lnbm1lbnRFeGFtcGxlcy5pbnRlcnZhbEl0ZW1zMSAhPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInVuZGVmaW5lZCIKICAgICAgICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGogaW4gcGFnZVZhcmlhYmxlLmNvbnNpZ25tZW50RXhhbXBsZXMuaW50ZXJ2YWxJdGVtczEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGtleXdvcmQgaW4gcGFnZVZhcmlhYmxlLmNvbnNpZ25tZW50RXhhbXBsZXMuaW50ZXJ2YWxJdGVtczFbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcERvYwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoIjpjb250YWlucygnIiArIGtleXdvcmQgKyAiJykiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbG9uZSgpIC8vY2xvbmUgdGhlIGVsZW1lbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNoaWxkcmVuKCkgLy9zZWxlY3QgYWxsIHRoZSBjaGlsZHJlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlKCkgLy9yZW1vdmUgYWxsIHRoZSBjaGlsZHJlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZW5kKCkgLy9hZ2FpbiBnbyBiYWNrIHRvIHNlbGVjdGVkIGVsZW1lbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigiOmNvbnRhaW5zKCciICsga2V5d29yZCArICInKSIpLmxlbmd0aCA+IDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGFibGVJbnRlcnZhbDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVJbnRlcnZhbDEgPSAkKHRoaXMpLmNsb3Nlc3QoInRhYmxlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ckluZGV4ID0gdGFibGVJbnRlcnZhbDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoInRib2R5IHRyIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmluZGV4KCQodGhpcykuY2xvc2VzdCgidHIiKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRySW5kZXggIT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJTdGFydDEgPT09IGZhbHNlIHx8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0clN0YXJ0MSA9PSAtMSB8fAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJTdGFydDEgPiB0ckluZGV4CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJTdGFydDEgPSB0ckluZGV4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGzDocK6wqV5IHJhIGh0bWwgY8OhwrvCp2EgcGjDocK6wqduIGludGVydmFsCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbnRlcnZhbEh0bWwgPSAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGludGVydmFsRWxlbWVudHMgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhYmxlSW50ZXJ2YWwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlSW50ZXJ2YWwuZmluZCgidGJvZHkgdHIiKS5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWJsZUludGVydmFsLmZpbmQoInRib2R5IHRyIikuaW5kZXgoJCh0aGlzKSkgPT0gdHJTdGFydCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZhbEh0bWwgKz0gJCgiPGRpdi8+IikuYXBwZW5kKCQodGhpcykpLmh0bWwoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2YWxFbGVtZW50cy5wdXNoKCQodGhpcykpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgaW4gaW50ZXJ2YWxFbGVtZW50cykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2YWxFbGVtZW50c1tpXS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcGxhY2VJbnRldmFsID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSBpbiBwYWdlVmFyaWFibGUuY29uc2lnbm1lbnRFeGFtcGxlcy5pbnRlcnZhbEl0ZW1zKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IGludGVydmFsSHRtbDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwYWdlVmFyaWFibGUuY29uc2lnbm1lbnRFeGFtcGxlcy5pbnRlcnZhbEl0ZW1zWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocGFnZVZhcmlhYmxlLmNvbnNpZ25tZW50RXhhbXBsZXMuaW50ZXJ2YWxJdGVtc1tpXVtrZXldKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wID0gdGhpcy5yZXBsYWNlQWxsKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAieyIgKyBrZXkgKyAifSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VWYXJpYWJsZS5jb25zaWdubWVudEV4YW1wbGVzLmludGVydmFsSXRlbXNbaV1ba2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlSW50ZXZhbCArPSB0ZW1wOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIC8vYXBwZW5kIGTDocK7wq8gbGnDocK74oChdSBpbnRlcnZhbCBleGFtcCB2w4MgbyB0YWJsZUludGVydmFsCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWJsZUludGVydmFsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUludGVydmFsLmZpbmQoInRib2R5IikuYXBwZW5kKHJlcGxhY2VJbnRldmFsKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGludGVydmFsSHRtbDEgPSAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGludGVydmFsRWxlbWVudHMxID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWJsZUludGVydmFsMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVJbnRlcnZhbDEuZmluZCgidGJvZHkgdHIiKS5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVJbnRlcnZhbDEuZmluZCgidGJvZHkgdHIiKS5pbmRleCgkKHRoaXMpKSA9PSB0clN0YXJ0MQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZhbEh0bWwxICs9ICQoIjxkaXYvPiIpLmFwcGVuZCgkKHRoaXMpKS5odG1sKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJCh0aGlzKS5vdXRlckhUTUwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZhbEVsZW1lbnRzMS5wdXNoKCQodGhpcykpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpIGluIGludGVydmFsRWxlbWVudHMxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2YWxFbGVtZW50czFbaV0ucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVwbGFjZUludGV2YWwxID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgaW4gcGFnZVZhcmlhYmxlLmNvbnNpZ25tZW50RXhhbXBsZXMuaW50ZXJ2YWxJdGVtczEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IGludGVydmFsSHRtbDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHBhZ2VWYXJpYWJsZS5jb25zaWdubWVudEV4YW1wbGVzLmludGVydmFsSXRlbXMxWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSB0aGlzLnJlcGxhY2VBbGwoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInsiICsga2V5ICsgIn0iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZVZhcmlhYmxlLmNvbnNpZ25tZW50RXhhbXBsZXMuaW50ZXJ2YWxJdGVtczFbaV1ba2V5XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlSW50ZXZhbDEgKz0gdGVtcDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlSW50ZXJ2YWwxLmZpbmQoInRib2R5IikuYXBwZW5kKHJlcGxhY2VJbnRldmFsMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlID0gdGVtcERvYy5odG1sKCk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGVtcGxhdGU7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgcmVwbGFjZUFsbDogZnVuY3Rpb24oc3RyLCBmaW5kLCByZXBsYWNlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKG5ldyBSZWdFeHAoZmluZCwgImciKSwgcmVwbGFjZSk7CiAgICAgICAgICAgICAgICB9LAoKICAgICAgICAgICAgfTsKICAgICAgICAgICAgJCgiI2NvbnRhaW5lciIpLmh0bWwocGFnZUZ1bmN0aW9ucy5yZXBsYWNlVGVtcGxhdGUoYDxkaXY+PHRhYmxlIHN0eWxlPSJ3aWR0aDoxMDAlOyI+PHRib2R5Pjx0cj48dGQgc3R5bGU9ImZvbnQtc2l6ZToxMXB4O3RleHQtYWxpZ246Y2VudGVyOyI+Jm5ic3A7PC90ZD48L3RyPjx0cj48dGQgc3R5bGU9ImZvbnQtc2l6ZToxMXB4O3RleHQtYWxpZ246Y2VudGVyOyI+PHNwYW4gc3R5bGU9ImZvbnQtZmFtaWx5OlZlcmRhbmEsIEdlbmV2YSwgc2Fucy1zZXJpZjtmb250LXNpemU6MTFweDsiPjxzdHJvbmc+Q+G7rEEgSMOATkcgTUFTVEVSUFJPPC9zdHJvbmc+PC9zcGFuPjwvdGQ+PC90cj48dHI+PHRkIHN0eWxlPSJmb250LXNpemU6MTFweDt0ZXh0LWFsaWduOmNlbnRlcjsiPjxzcGFuIHN0eWxlPSJmb250LWZhbWlseTpWZXJkYW5hLCBHZW5ldmEsIHNhbnMtc2VyaWY7Zm9udC1zaXplOjEwcHg7Ij7EkOG7i2EgY2jhu4k6IHtESUFfQ0hJX0RPQU5IX05HSElFUH08L3NwYW4+PC90ZD48L3RyPjx0cj48dGQgc3R5bGU9ImZvbnQtc2l6ZToxMXB4O3RleHQtYWxpZ246Y2VudGVyOyI+PHNwYW4gc3R5bGU9ImZvbnQtZmFtaWx5OlZlcmRhbmEsIEdlbmV2YSwgc2Fucy1zZXJpZjtmb250LXNpemU6MTBweDsiPsSQaeG7h24gdGhv4bqhaTogMDg3ODk2MjIyMjwvc3Bhbj48L3RkPjwvdHI+PC90Ym9keT48L3RhYmxlPjx0YWJsZSBzdHlsZT0id2lkdGg6MTAwJTsiPjx0Ym9keT48dHI+PHRkIHN0eWxlPSJmb250LXNpemU6MTFweDt0ZXh0LWFsaWduOmNlbnRlcjsiPjxzcGFuIHN0eWxlPSJmb250LWZhbWlseTpWZXJkYW5hLCBHZW5ldmEsIHNhbnMtc2VyaWY7Zm9udC1zaXplOjExcHg7Ij5T4buRIEjEkDoge09SREVSX0NPREV9PC9zcGFuPjwvdGQ+PC90cj48dHI+PHRkIHN0eWxlPSJmb250LXNpemU6MTFweDt0ZXh0LWFsaWduOmNlbnRlcjsiPjxzcGFuIHN0eWxlPSJmb250LWZhbWlseTpWZXJkYW5hLCBHZW5ldmEsIHNhbnMtc2VyaWY7Zm9udC1zaXplOjExcHg7Ij5OZ8OgeSBiw6FuIGjDoG5nOiB7T1JERVJfREFURX08L3NwYW4+PC90ZD48L3RyPjwvdGJvZHk+PC90YWJsZT48ZGl2IGNsYXNzPSJwcmludEJveCI+PGRpdiBzdHlsZT0icGFkZGluZzoxMHB4IDAgMDt0ZXh0LWFsaWduOmNlbnRlcjsiPjxzcGFuIHN0eWxlPSJmb250LWZhbWlseTpWZXJkYW5hLCBHZW5ldmEsIHNhbnMtc2VyaWY7Zm9udC1zaXplOjE3cHg7Ij48c3Ryb25nIHN0eWxlPSJmb250LXNpemU6MTJweDsiPkhPw4EgxJDGoE4gQsOBTiBIw4BORzwvc3Ryb25nPjwvc3Bhbj48L2Rpdj48dGFibGUgc3R5bGU9Im1hcmdpbjoxMHB4IDAgMTVweDt3aWR0aDoxMDAlOyI+PHRib2R5Pjx0cj48dGQgc3R5bGU9ImZvbnQtc2l6ZToxMXB4OyI+PHNwYW4gc3R5bGU9ImZvbnQtZmFtaWx5OlZlcmRhbmEsIEdlbmV2YSwgc2Fucy1zZXJpZjtmb250LXNpemU6MTBweDsiPktow6FjaCBow6BuZzoge0NVU1RPTUVSX05BTUV9PC9zcGFuPjwvdGQ+PC90cj48dHI+PHRkIHN0eWxlPSJmb250LXNpemU6MTFweDsiPjxzcGFuIHN0eWxlPSJmb250LWZhbWlseTpWZXJkYW5hLCBHZW5ldmEsIHNhbnMtc2VyaWY7Zm9udC1zaXplOjEwcHg7Ij5TxJBUOntDVVNUT01FUl9QSE9ORX08L3NwYW4+PC90ZD48L3RyPjx0cj48dGQgc3R5bGU9ImZvbnQtc2l6ZToxMXB4OyI+PHNwYW4gc3R5bGU9ImZvbnQtZmFtaWx5OlZlcmRhbmEsIEdlbmV2YSwgc2Fucy1zZXJpZjtmb250LXNpemU6MTBweDsiPsSQ4buLYSBjaOG7iToge0NVU1RPTUVSX0FERFJFU1N9PC9zcGFuPjwvdGQ+PC90cj48L3Rib2R5PjwvdGFibGU+PHRhYmxlIGNsYXNzPSJjay10YWJsZS1yZXNpemVkIiBzdHlsZT0id2lkdGg6MTAwJTsiPjxjb2xncm91cD48Y29sIHN0eWxlPSJ3aWR0aDozMS4wNCU7Ij48Y29sIHN0eWxlPSJ3aWR0aDoyNC44JTsiPjxjb2wgc3R5bGU9IndpZHRoOjE4LjI3JTsiPjxjb2wgc3R5bGU9IndpZHRoOjI1Ljg5JTsiPjwvY29sZ3JvdXA+PHRib2R5Pjx0cj48dGQgc3R5bGU9IndpZHRoOjM1JTsiPjxzcGFuIHN0eWxlPSJmb250LWZhbWlseTpWZXJkYW5hLCBHZW5ldmEsIHNhbnMtc2VyaWY7Zm9udC1zaXplOjhweDsiPjxzdHJvbmc+U+G6o24gcGjhuqltPC9zdHJvbmc+PC9zcGFuPjwvdGQ+PHRkIHN0eWxlPSJ3aWR0aDozNCU7Ij48c3BhbiBzdHlsZT0iZm9udC1mYW1pbHk6VmVyZGFuYSwgR2VuZXZhLCBzYW5zLXNlcmlmO2ZvbnQtc2l6ZTo4cHg7Ij48c3Ryb25nPkdoaSBjaMO6PC9zdHJvbmc+PC9zcGFuPjwvdGQ+PHRkIHN0eWxlPSJ3aWR0aDoxNSU7Ij48c3BhbiBzdHlsZT0iZm9udC1mYW1pbHk6VmVyZGFuYSwgR2VuZXZhLCBzYW5zLXNlcmlmO2ZvbnQtc2l6ZTo4cHg7Ij48c3Ryb25nPlNMPC9zdHJvbmc+PC9zcGFuPjwvdGQ+PHRkIHN0eWxlPSJ3aWR0aDozMCU7Ij48c3BhbiBzdHlsZT0iZm9udC1mYW1pbHk6VmVyZGFuYSwgR2VuZXZhLCBzYW5zLXNlcmlmO2ZvbnQtc2l6ZTo4cHg7Ij48c3Ryb25nPlRow6BuaCB0aeG7gW48L3N0cm9uZz48L3NwYW4+PC90ZD48L3RyPjx0cj48dGQ+PHNwYW4gc3R5bGU9ImZvbnQtZmFtaWx5OlZlcmRhbmEsIEdlbmV2YSwgc2Fucy1zZXJpZjtmb250LXNpemU6OXB4OyI+e1RFTl9TUH0gLSB7RFZUX1NQfTwvc3Bhbj48L3RkPjx0ZD48c3BhbiBzdHlsZT0iZm9udC1mYW1pbHk6VmVyZGFuYSwgR2VuZXZhLCBzYW5zLXNlcmlmO2ZvbnQtc2l6ZTo5cHg7Ij57Tk9URV9TUH08L3NwYW4+PC90ZD48dGQgc3R5bGU9InBhZGRpbmc6MnB4OyI+PHNwYW4gc3R5bGU9ImZvbnQtZmFtaWx5OlZlcmRhbmEsIEdlbmV2YSwgc2Fucy1zZXJpZjtmb250LXNpemU6OXB4OyI+e1FVQU5USVRZfTwvc3Bhbj48L3RkPjx0ZD48c3BhbiBzdHlsZT0iZm9udC1mYW1pbHk6VmVyZGFuYSwgR2VuZXZhLCBzYW5zLXNlcmlmO2ZvbnQtc2l6ZTo5cHg7Ij57VE9UQUx9PC9zcGFuPjwvdGQ+PC90cj48dHI+PHRkIGNvbHNwYW49IjQiPjxzcGFuIHN0eWxlPSJmb250LWZhbWlseTpWZXJkYW5hLCBHZW5ldmEsIHNhbnMtc2VyaWY7Zm9udC1zaXplOjEwcHg7Ij57UFJJQ0V9PC9zcGFuPjwvdGQ+PC90cj48L3Rib2R5PjwvdGFibGU+PHRhYmxlIGNsYXNzPSJjay10YWJsZS1yZXNpemVkIiBzdHlsZT0iYm9yZGVyLWNvbGxhcHNlOmNvbGxhcHNlO3dpZHRoOjk5Ljg5JTsiIGJvcmRlcj0iMCIgY2VsbHBhZGRpbmc9IjMiIGNlbGxzcGFjaW5nPSIwIj48Y29sZ3JvdXA+PGNvbCBzdHlsZT0id2lkdGg6NzMuNzklOyI+PGNvbCBzdHlsZT0id2lkdGg6MjYuMjElOyI+PC9jb2xncm91cD48dGJvZHk+PHRyPjx0ZCBzdHlsZT0iZm9udC1zaXplOjExcHg7dGV4dC1hbGlnbjpyaWdodDt3aGl0ZS1zcGFjZTpub3dyYXA7Ij48c3BhbiBzdHlsZT0iZm9udC1mYW1pbHk6VmVyZGFuYSwgR2VuZXZhLCBzYW5zLXNlcmlmO2ZvbnQtc2l6ZTo4cHg7Ij48c3Ryb25nPlThu5VuZyB0aeG7gW4gaMOgbmc6PC9zdHJvbmc+PC9zcGFuPjwvdGQ+PHRkIHN0eWxlPSJmb250LXNpemU6MTFweDt0ZXh0LWFsaWduOnJpZ2h0OyI+PHNwYW4gc3R5bGU9ImZvbnQtZmFtaWx5OlZlcmRhbmEsIEdlbmV2YSwgc2Fucy1zZXJpZjtmb250LXNpemU6OHB4OyI+PHN0cm9uZz57VE9UQUxfV0lUSE9VVF9ESVNDT1VOVH08L3N0cm9uZz48L3NwYW4+PC90ZD48L3RyPjx0cj48dGQgc3R5bGU9ImZvbnQtc2l6ZToxMXB4O3RleHQtYWxpZ246cmlnaHQ7d2hpdGUtc3BhY2U6bm93cmFwOyI+PHNwYW4gc3R5bGU9ImZvbnQtZmFtaWx5OlZlcmRhbmEsIEdlbmV2YSwgc2Fucy1zZXJpZjtmb250LXNpemU6OHB4OyI+PHN0cm9uZz5DaGnhur90IGto4bqldSA6PC9zdHJvbmc+PC9zcGFuPjwvdGQ+PHRkIHN0eWxlPSJmb250LXNpemU6MTFweDt0ZXh0LWFsaWduOnJpZ2h0OyI+PHNwYW4gc3R5bGU9ImZvbnQtZmFtaWx5OlZlcmRhbmEsIEdlbmV2YSwgc2Fucy1zZXJpZjtmb250LXNpemU6OHB4OyI+PHN0cm9uZz57VE9UQUxfRElTQ09VTlRfUFJJQ0V9PC9zdHJvbmc+PC9zcGFuPjwvdGQ+PC90cj48dHI+PHRkIHN0eWxlPSJmb250LXNpemU6MTFweDt0ZXh0LWFsaWduOnJpZ2h0O3doaXRlLXNwYWNlOm5vd3JhcDsiPjxzcGFuIHN0eWxlPSJmb250LWZhbWlseTpWZXJkYW5hLCBHZW5ldmEsIHNhbnMtc2VyaWY7Zm9udC1zaXplOjhweDsiPjxzdHJvbmc+VGh14bq/IDo8L3N0cm9uZz48L3NwYW4+PC90ZD48dGQgc3R5bGU9ImZvbnQtc2l6ZToxMXB4O3RleHQtYWxpZ246cmlnaHQ7Ij48c3BhbiBzdHlsZT0iZm9udC1mYW1pbHk6VmVyZGFuYSwgR2VuZXZhLCBzYW5zLXNlcmlmO2ZvbnQtc2l6ZTo4cHg7Ij48c3Ryb25nPntUQVh9PC9zdHJvbmc+PC9zcGFuPjwvdGQ+PC90cj48dHI+PHRkIHN0eWxlPSJmb250LXNpemU6MTFweDt0ZXh0LWFsaWduOnJpZ2h0O3doaXRlLXNwYWNlOm5vd3JhcDsiPjxzcGFuIHN0eWxlPSJmb250LWZhbWlseTpWZXJkYW5hLCBHZW5ldmEsIHNhbnMtc2VyaWY7Zm9udC1zaXplOjhweDsiPjxzdHJvbmc+VOG7lW5nIHRoYW5oIHRvw6FuOjwvc3Ryb25nPjwvc3Bhbj48L3RkPjx0ZCBzdHlsZT0iZm9udC1zaXplOjExcHg7dGV4dC1hbGlnbjpyaWdodDsiPjxzcGFuIHN0eWxlPSJmb250LWZhbWlseTpWZXJkYW5hLCBHZW5ldmEsIHNhbnMtc2VyaWY7Zm9udC1zaXplOjhweDsiPjxzdHJvbmc+e1RPTkdfVElFTn08L3N0cm9uZz48L3NwYW4+PC90ZD48L3RyPjx0cj48dGQgc3R5bGU9ImZvbnQtc2l6ZToxMXB4O3RleHQtYWxpZ246bGVmdDsiIGNvbHNwYW49IjIiPjxzcGFuIHN0eWxlPSJmb250LWZhbWlseTpWZXJkYW5hLCBHZW5ldmEsIHNhbnMtc2VyaWY7Zm9udC1zaXplOjEwcHg7Ij48aT57TU9ORVlfV09SRFN9PC9pPjwvc3Bhbj48L3RkPjwvdHI+PC90Ym9keT48L3RhYmxlPjx0YWJsZSBzdHlsZT0id2lkdGg6MTAwJTsiPjx0Ym9keT48dHI+PHRkIHN0eWxlPSJmb250LXNpemU6MTFweDt0ZXh0LWFsaWduOmNlbnRlcjsiPjxzcGFuIHN0eWxlPSJmb250LWZhbWlseTpWZXJkYW5hLCBHZW5ldmEsIHNhbnMtc2VyaWY7Ij48aT5D4bqjbSDGoW4gdsOgIGjhurluIGfhurdwIGzhuqFpITwvaT48L3NwYW4+PC90ZD48L3RyPjx0cj48dGQgc3R5bGU9ImZvbnQtc2l6ZTo5cHg7dGV4dC1hbGlnbjpjZW50ZXI7Ij48c3BhbiBzdHlsZT0iZm9udC1mYW1pbHk6VmVyZGFuYSwgR2VuZXZhLCBzYW5zLXNlcmlmOyI+PGk+UG93ZXJlZCBieSBNQVNURVJQUk8uPC9pPjwvc3Bhbj48L3RkPjwvdHI+PC90Ym9keT48L3RhYmxlPjwvZGl2PjwvZGl2PmApKTsKICAgICAgICB9CiAgICAgICAgcHJpbnRUZW1wbGF0ZSgpCiAgICA8L3NjcmlwdD4KPC9ib2R5PgoKPC9odG1sPgo=";
